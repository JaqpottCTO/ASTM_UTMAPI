---
openapi: 3.1.1
info:
  title: ASTM UAM PSU DSS API
  description: |-
    Interface definitions for communication between a UAS Service Supplier (USS) and a Discovery and Synchronization Service (DSS), as well as for communication between two USSs.
    DSS functionality includes identification of peer UTM USS instances (managing flight operational intents and constraints). USS functionality includes sharing details of flight operational intents and constraints.
    Note: Unless otherwise specified, fields specified in a message but not declared in the API must be ignored.
    Whenever a object-type field may be omitted, it may also be set to null for the same effect.
  version: 0.0.0
servers:
- url: /
security:
- Authority:
  - utm.strategic_coordination
- Authority:
  - utm.conformance_monitoring_sa
- Authority:
  - utm.resource_management
- Authority:
  - utm.resource_processing
- Authority:
  - utm.availability_arbitration

tags:
- name: Operational intent references
  description: Endpoints exposed by the DSS for interaction with references to operational intents.
- name: Resource references
  description: Endpoints exposed by the DSS for interaction with references to resources.
- name: Subscriptions
  description: Endpoints exposed by the DSS for interaction with subscription entities.
- name: Reports
  description: Endpoints exposed by the DSS for reporting peer DSS issues.
- name: Availability
  description: Endpoints exposed by the DSS for declaring USS availability.
- name: Logging
  description: "Pseudo-endpoints not intended to be implemented literally, but rather to illustrate logging data formats"
- name: dss
  description: Endpoints exposed by the DSS server.

paths:
  /dss/v1/operational_intent_references/query:
    summary: "Query all operational intents in the DSS that intersect with a specified geographic area, altitude-range, and time-range."
    description: Interface to operational intent references in the DSS.
    post:
      tags:
      - Operational intent references
      - dss
      summary: Query all operational intent references in the specified area/volume/time from the DSS.
      description: "Note that this endpoint does not produce any mutations in the DSS despite using the HTTP POST verb.  The HTTP GET verb is traditionally used for operations like this one, but requiring or using a request body for HTTP GET requests is non-standard and not supported by some architectures.  POST is used here instead of GET to ensure robust support for the use of a request body."
      operationId: queryOperationalIntentReferences
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryOperationalIntentReferenceParameters'
        required: true
      responses:
        "200":
          description: Operational intents were successfully retrieved.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryOperationalIntentReferenceResponse'
        "400":
          description: One or more input parameters were missing or invalid.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "413":
          description: The requested area was too large.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.strategic_coordination
      - Authority:
        - utm.resource_management
  /dss/v1/operational_intent_references/{entityid}:
    summary: Create/read endpoint for a specified operational intent reference in the DSS.
    get:
      tags:
      - Operational intent references
      - dss
      summary: Retrieve the specified operational intent reference from the DSS.
      operationId: getOperationalIntentReference
      parameters:
      - name: entityid
        in: path
        description: EntityID of the operational intent.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
      responses:
        "200":
          description: Operational intent reference was retrieved successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetOperationalIntentReferenceResponse'
        "400":
          description: One or more input parameters were missing or invalid.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "404":
          description: The requested Entity could not be found.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.strategic_coordination
      - Authority:
        - utm.conformance_monitoring_sa
      - Authority:
        - utm.resource_management
    put:
      tags:
      - Operational intent references
      - dss
      summary: Create the specified operational intent reference in the DSS.
      operationId: createOperationalIntentReference
      parameters:
      - name: entityid
        in: path
        description: EntityID of the operational intent.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PutOperationalIntentReferenceParameters'
        required: true
      responses:
        "201":
          description: An operational intent reference was created successfully in the DSS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChangeOperationalIntentReferenceResponse'
        "400":
          description: |-
            * One or more input parameters were missing or invalid.
            * The request attempted to mutate the operational intent in a disallowed way.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "409":
          description: |-
            * The provided key did not prove knowledge of all current and relevant airspace Entities
            * Despite repeated attempts, the DSS was unable to complete the update because of other simultaneous changes.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AirspaceConflictResponse'
        "412":
          description: The client attempted to transition the operational intent to Accepted or Activated while marked as Down in the DSS.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "413":
          description: The area of the operational intent is too large.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.strategic_coordination
  /dss/v1/operational_intent_references/{entityid}/{ovn}:
    summary: Update endpoint for a specified operational intent reference in the DSS.
    put:
      tags:
      - Operational intent references
      - dss
      summary: Update the specified operational intent reference in the DSS.
      operationId: updateOperationalIntentReference
      parameters:
      - name: entityid
        in: path
        description: EntityID of the operational intent.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
      - name: ovn
        in: path
        description: Opaque version number of the existing operational intent reference.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityOVN'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PutOperationalIntentReferenceParameters'
        required: true
      responses:
        "200":
          description: An operational intent reference was updated successfully in the DSS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChangeOperationalIntentReferenceResponse'
        "400":
          description: |-
            * One or more input parameters were missing or invalid.
            * The request attempted to mutate the operational intent in a disallowed way.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "409":
          description: |-
            * The provided key did not prove knowledge of all current and relevant airspace Entities
            * The provided `ovn` does not match the current version of the existing operational intent.
            * Despite repeated attempts, the DSS was unable to complete the update because of other simultaneous changes.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AirspaceConflictResponse'
        "412":
          description: The client attempted to transition the operational intent to Accepted or Activated while marked as Down in the DSS.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "413":
          description: The area of the operational intent is too large.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.strategic_coordination
    delete:
      tags:
      - Operational intent references
      - dss
      summary: Remove the specified operational intent reference from the DSS.
      operationId: deleteOperationalIntentReference
      parameters:
      - name: entityid
        in: path
        description: EntityID of the operational intent.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
      - name: ovn
        in: path
        description: Opaque version number of the existing operational intent reference.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityOVN'
      responses:
        "200":
          description: The specified operational intent was successfully removed from the DSS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChangeOperationalIntentReferenceResponse'
        "400":
          description: |-
            * One or more input parameters were missing or invalid.
            * The request attempted to mutate the operational intent in a disallowed way.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "404":
          description: The requested Entity could not be found.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "409":
          description: |-
            * The provided `ovn` does not match the current version of the existing operational intent.
            * Despite repeated attempts, the DSS was unable to complete the update because of other simultaneous changes.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "412":
          description: The client attempted to delete the operational intent while marked as Down in the DSS.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.strategic_coordination
  /dss/v1/resource_references/query:
    summary: Query all resource references in the DSS that intersect with a specified area/volume/time.
    post:
      tags:
      - Resource references
      - dss
      summary: Query all resource references in the specified area/volume from the DSS.
      description: "Note that this endpoint does not produce any mutations in the DSS despite using the HTTP POST verb.  The HTTP GET verb is traditionally used for operations like this one, but requiring or using a request body for HTTP GET requests is non-standard and not supported by some architectures.  POST is used here instead of GET to ensure robust support for the use of a request body."
      operationId: queryResourceReferences
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryResourceReferenceParameters'
        required: true
      responses:
        "200":
          description: Resource references were successfully retrieved.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryResourceReferencesResponse'
        "400":
          description: One or more input parameters were missing or invalid.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "413":
          description: The requested area was too large.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.resource_management
      - Authority:
        - utm.resource_processing
      - Authority:
        - utm.conformance_monitoring_sa
  /dss/v1/resource_references/{entityid}:
    summary: Create/read endpoint for a specified resource reference in the DSS.
    get:
      tags:
      - Resource references
      - dss
      summary: Retrieve the specified resource reference from the DSS.
      operationId: getResourceReference
      parameters:
      - name: entityid
        in: path
        description: EntityID of the resource.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
      responses:
        "200":
          description: Resource reference was retrieved successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetResourceReferenceResponse'
        "400":
          description: One or more input parameters were missing or invalid.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "404":
          description: The requested Entity could not be found.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.resource_management
      - Authority:
        - utm.resource_processing
      - Authority:
        - utm.conformance_monitoring_sa
    put:
      tags:
      - Resource references
      - dss
      summary: Create the specified resource reference in the DSS.
      operationId: createResourceReference
      parameters:
      - name: entityid
        in: path
        description: EntityID of the resource.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostResourceReferenceParameters'
        required: true
      responses:
        "201":
          description: A resource reference was created successfully in the DSS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChangeResourceReferenceResponse'
        "400":
          description: |-
            * One or more input parameters were missing or invalid.
            * The request attempted to mutate the resource in a disallowed way.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "409":
          description: |-
            * A resource with the provided ID already exists.
            * Despite repeated attempts, the DSS was unable to complete the update because of other simultaneous changes.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "413":
          description: The area of the resource is too large.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "432":
          description: The resource start and end times don’t align with the bin duration.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'                    
      security:
      - Authority:
        - utm.resource_management
  /dss/v1/resource_references/{entityid}/{ovn}:
    summary: Update/delete endpoint for a specified resource reference in the DSS.
    put:
      tags:
      - Resource references
      - dss
      summary: Update the specified resource reference in the DSS.
      operationId: updateResourceReference
      parameters:
      - name: entityid
        in: path
        description: EntityID of the resource.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
      - name: ovn
        in: path
        description: Opaque version number of the existing operational intent reference.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityOVN'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PutResourceReferenceParameters'
        required: true
      responses:
        "200":
          description: A resource reference was updated successfully in the DSS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChangeResourceReferenceResponse'
        "400":
          description: |-
            * One or more input parameters were missing or invalid.
            * The request attempted to mutate the resource in a disallowed way.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "409":
          description: |-
            * The provided `ovn` does not match the current version of the existing resource.
            * Despite repeated attempts, the DSS was unable to complete the update because of other simultaneous changes.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "413":
          description: The area of the resource is too large.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "432":
          description: The resource start and end times don’t align with the bin duration.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'                 
      security:
      - Authority:
        - utm.resource_management
    delete:
      tags:
      - Resource references
      - dss
      summary: Delete the specified resource reference from the DSS.
      operationId: deleteResourceReference
      parameters:
      - name: entityid
        in: path
        description: EntityID of the resource.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
      - name: ovn
        in: path
        description: Opaque version number of the existing operational intent reference.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityOVN'
      responses:
        "200":
          description: The resource was successfully removed from the DSS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChangeResourceReferenceResponse'
        "400":
          description: |-
            * One or more input parameters were missing or invalid.
            * The request attempted to mutate the resource in a disallowed way.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "404":
          description: The requested Entity could not be found.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "409":
          description: |-
            * The provided `ovn` does not match the current version of the existing resource.
            * Despite repeated attempts, the DSS was unable to complete the update because of other simultaneous changes.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.resource_management
  /dss/v1/subscriptions/query:
    summary: Subscriptions for airspace updates to a volume of interest.
    post:
      tags:
      - Subscriptions
      - dss
      summary: Query all subscriptions in the specified area/volume from the DSS.
      description: |-
        Query subscriptions intersecting an area of interest.  Subscription notifications are only triggered by (and contain full information of) changes to, creation of, or deletion of, Entities referenced by or stored in the DSS; they do not involve any data transfer (such as remote ID telemetry updates) apart from Entity information.
        A query of subscriptions may be needed to validate what subscriptions a subscriber has in place, or to identify existing subscription after a loss of data on the part of the subscriber.
        Note that this parameter is a JSON object (in the 'request-body'). Note that either or both of the 'altitude' and 'time' values may be omitted from this parameter.
        Only subscriptions belonging to the caller are returned.  This endpoint would be used if a USS lost track of subscriptions they had created and/or wanted to resolve an error indicating that they had too many existing subscriptions in an area.
      operationId: querySubscriptions
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QuerySubscriptionParameters'
        required: true
      responses:
        "200":
          description: Subscriptions were retrieved successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuerySubscriptionsResponse'
        "400":
          description: One or more input parameters were missing or invalid.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "413":
          description: The requested area was too large.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.strategic_coordination
      - Authority:
        - utm.conformance_monitoring_sa
      - Authority:
        - utm.resource_processing
  /dss/v1/subscriptions/{subscriptionid}:
    summary: Create/read endpoint for a specific subscription in the DSS.
    get:
      tags:
      - Subscriptions
      - dss
      summary: Retrieve the specified subscription from the DSS.
      description: Retrieve a specific subscription.
      operationId: getSubscription
      parameters:
      - name: subscriptionid
        in: path
        description: SubscriptionID of the subscription of interest.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/SubscriptionID'
      responses:
        "200":
          description: Subscription information was retrieved successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetSubscriptionResponse'
        "400":
          description: One or more input parameters were missing or invalid.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "404":
          description: A subscription with the specified ID was not found.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.strategic_coordination
      - Authority:
        - utm.conformance_monitoring_sa
      - Authority:
        - utm.resource_processing
    put:
      tags:
      - Subscriptions
      - dss
      summary: Create the specified subscription in the DSS.
      description: |-
        Create a subscription.
        Subscription notifications are only triggered by (and contain full information of) changes to, creation of, or deletion of, Entities referenced by or stored in the DSS; they do not involve any data transfer (such as remote ID telemetry updates) apart from Entity information.
      operationId: createSubscription
      parameters:
      - name: subscriptionid
        in: path
        description: SubscriptionID of the subscription of interest.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/SubscriptionID'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PutSubscriptionParameters'
        required: true
      responses:
        "200":
          description: A new subscription was created successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PutSubscriptionResponse'
        "400":
          description: |-
            * One or more input parameters were missing or invalid.
            * The request attempted to mutate the subscription in a disallowed way.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: |-
            * The access token was decoded successfully but did not include a scope appropriate to this endpoint or the request.
            * Client attempted to request notifications for an Entity type to which the scopes included in the access token do not provide access.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "409":
          description: |-
            * A subscription with the specified ID already exists.
            * Despite repeated attempts, the DSS was unable to complete the update because of other simultaneous changes.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client may have issued too many requests within a small period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.strategic_coordination
      - Authority:
        - utm.conformance_monitoring_sa
      - Authority:
        - utm.resource_processing
  /dss/v1/subscriptions/{subscriptionid}/{version}:
    summary: Update/delete a specific subscription in the DSS.
    put:
      tags:
      - Subscriptions
      - dss
      summary: Update the specified subscription in the DSS.
      description: |-
        Update a subscription.
        Subscription notifications are only triggered by (and contain full information of) changes to, creation of, or deletion of, Entities referenced by or stored in the DSS; they do not involve any data transfer (such as remote ID telemetry updates) apart from Entity information.
        The standard requires each operational intent to have a subscription that cover the 4D volume of the operational intent.  If a USS attempts to update a subscription upon which an operational intent depends, and this update would cause the operational intent to lose subscription coverage, the update will be rejected by the DSS as a bad request.
      operationId: updateSubscription
      parameters:
      - name: subscriptionid
        in: path
        description: SubscriptionID of the subscription of interest.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/SubscriptionID'
      - name: version
        in: path
        description: Version of the subscription to be modified.
        required: true
        style: simple
        explode: false
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PutSubscriptionParameters'
        required: true
      responses:
        "200":
          description: A subscription was updated successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PutSubscriptionResponse'
        "400":
          description: |-
            * One or more input parameters were missing or invalid.
            * The request attempted to mutate the subscription in a disallowed way.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: |-
            * The access token was decoded successfully but did not include a scope appropriate to this endpoint or the request.
            * Client attempted to request notifications for an Entity type to which the scopes included in the access token do not provide access.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "409":
          description: |-
            * A subscription with the specified ID already exists and is managed by a different client.
            * The provided `version` does not match the current subscription.
            * Despite repeated attempts, the DSS was unable to complete the update because of other simultaneous changes.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client may have issued too many requests within a small period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.strategic_coordination
      - Authority:
        - utm.conformance_monitoring_sa
      - Authority:
        - utm.resource_processing
    delete:
      tags:
      - Subscriptions
      - dss
      summary: Remove the specified subscription from the DSS.
      description: "The standard requires each operational intent to have a subscription that cover the 4D volume of the operational intent.  If a USS attempts to delete a subscription upon which an operational intent depends, the deletion will be rejected by the DSS as a bad request."
      operationId: deleteSubscription
      parameters:
      - name: subscriptionid
        in: path
        description: SubscriptionID of the subscription of interest.
        required: true
        style: simple
        explode: false
        schema:
          $ref: '../shared-components/schemas.yaml#/components/schemas/SubscriptionID'
      - name: version
        in: path
        description: Version of the subscription to be modified.
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: Subscription was successfully removed from DSS.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteSubscriptionResponse'
        "400":
          description: One or more input parameters were missing or invalid.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: The access token was decoded successfully but did not include a scope appropriate to this endpoint.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "404":
          description: A subscription with the specified ID was not found.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "409":
          description: |-
            * A subscription with the specified ID is managed by a different client.
            * The provided `version` does not match the current subscription.
            * Despite repeated attempts, the DSS was unable to complete the deletion because of other simultaneous changes.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.strategic_coordination
      - Authority:
        - utm.conformance_monitoring_sa
      - Authority:
        - utm.resource_processing

  /dss/v1/reports:
    $ref: '../shared-components/pathitems.yaml#/components/pathItems/path_ErrorReports'

  /dss/v1/uss_availability/{uss_id}:
    summary: Availability status of a USS
    get:
      tags:
      - Availability
      - dss
      summary: Get availability status of a USS.
      description: Get availability status of a USS.
      operationId: getPsuAvailability
      parameters:
      - name: uss_id
        in: path
        description: Client ID (matching their `sub` in access tokens) of the USS to which this availability applies.
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: Availability status of specified USS was successfully retrieved.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UssAvailabilityStatusResponse'
        "400":
          description: '* One or more parameters were missing or invalid.'
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: '* The access token was decoded successfully but did not include a scope appropriate to this endpoint or the request.'
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.availability_arbitration
      - Authority:
        - utm.strategic_coordination
      - Authority:
        - utm.conformance_monitoring_sa
    put:
      tags:
      - Availability
      - dss
      summary: Set availability status of a USS.
      description: Set availability status of a USS.
      operationId: setPsuAvailability
      parameters:
      - name: uss_id
        in: path
        description: Client ID (matching their `sub` in access tokens) of the USS to which this availability applies.
        required: true
        style: simple
        explode: false
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetUssAvailabilityStatusParameters'
        required: true
      responses:
        "200":
          description: Availability status of specified USS was successfully updated. Returns 
            list of subscribers who must be notified. 
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChangeUssAvailabilityStatusResponse'
        "400":
          description: '* One or more parameters were missing or invalid.'
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "401":
          description: "Bearer access token was not provided in Authorization header, token could not be decoded, or token was invalid."
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "403":
          description: '* The access token was decoded successfully but did not include a scope appropriate to this endpoint or the request.'
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
        "429":
          description: The client issued too many requests in a short period of time.
          content:
            application/json:
              schema:
                $ref: '../shared-components/schemas.yaml#/components/schemas/ErrorResponse'
      security:
      - Authority:
        - utm.availability_arbitration
components:
  securitySchemes:
    Authority:
      $ref: '../shared-components/security.yaml#/components/securitySchemes/Authority'

  schemas:
    Key:
      type: array
      description: "Proof that a client has obtained the latest airspace content, used to ensure that write operations to the DSS occur only when the latest content is known (i.e., has been read). The client is required to pass a current Key constructed from information obtained with previous read operations and subsequent requests for full information, and optionally, subscription updates for write operations to the DSS.  The contents of this data structure are generated by the client."
      items:
        $ref: '../shared-components/schemas.yaml#/components/schemas/EntityOVN'
      default: []
    ResourceOccupation:
      required:
        - resource_id
        - resource_ovn
        - operation_ovns
      type: object
      properties:
        resource_id:
          description: |-
            The ID of a resources being occupied or crossed by the operational intent. 
            Details of the crossing times and durations are also shared peer-to-peer when the
            operational intent trajectory is shared. 
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
        resource_ovn:
          description: |-
            The OVN of the resource being occupied or crossed by the operational intent. 
            This proves the operation considers the latest status and capacity of the resource. 
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityOVN'
        operation_ovns:
          description: |-
            The OVNs of all operations contributing to demand at this resource during the
            relevant times based upon resource demand & capacity requirements. 
          type: array
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/EntityOVN'
    Volume4DExtent:
      required:
      - volume4D
      - occupied_resources
      type: object
      properties:
        volume4d:
          $ref: '../shared-components/schemas.yaml#/components/schemas/Volume4D'
        occupied_resources:
          type: array
          items:
            $ref: '#/components/schemas/ResourceOccupation'
          description: List of resources which will be fully occupied during the duration of the volume.  
      description: |-
        A 4D volume which includes a list of resources which will be fully occupied 
        during the duration of the volume. 
    SubscriberToNotify:
      required:
      - subscriptions
      - uss_base_url
      type: object
      properties:
        subscriptions:
          minItems: 1
          type: array
          description: Subscription(s) prompting this notification.
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/SubscriptionState'
        uss_base_url:
          $ref: '#/components/schemas/SubscriptionUssBaseURL'
      description: "Subscriber to notify of a change in the airspace.  This is provided by the DSS to a client changing the airspace, and it is the responsibility of that client to send a notification to the specified USS according to the change made to the airspace."
    Subscription:
      required:
      - id
      - notification_index
      - uss_base_url
      - version
      type: object
      properties:
        id:
          $ref: '../shared-components/schemas.yaml#/components/schemas/SubscriptionID'
        version:
          type: string
          description: Version of the subscription that the DSS changes every time a USS changes the subscription.  The DSS incrementing the notification_index does not constitute a change that triggers a new version.  A USS must specify this version when modifying an existing subscription to ensure consistency in read-modify-write operations and distributed systems.
        notification_index:
          $ref: '../shared-components/schemas.yaml#/components/schemas/SubscriptionNotificationIndex'
        time_start:
          description: "If set, this subscription will not receive notifications involving airspace changes entirely before this time."
          $ref: '../shared-components/schemas.yaml#/components/schemas/Time'
        time_end:
          description: "If set, this subscription will not receive notifications involving airspace changes entirely after this time."
          $ref: '../shared-components/schemas.yaml#/components/schemas/Time'
        uss_base_url:
          $ref: '#/components/schemas/SubscriptionUssBaseURL'
        notify_for_operational_intents:
          type: boolean
          description: "If true, trigger notifications when operational intents are created, updated, or deleted.  Otherwise, changes in operational intents should not trigger notifications.  The scope utm.strategic_coordination is required to set this flag true."
          default: false
        notify_for_resources:
          type: boolean
          description: "If true, trigger notifications when resources are created, updated, or deleted.  Otherwise, changes in resources should not trigger notifications.  The scope utm.constraint_processing is required to set this flag true."
          default: false
        implicit_subscription:
          type: boolean
          description: "True if this subscription was implicitly created by the DSS via the creation of an operational intent, and should therefore be deleted by the DSS when that operational intent is deleted."
          default: false
        dependent_operational_intents:
          type: array
          description: List of IDs for operational intents that are dependent on this subscription.
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
          default: []
      description: "Specification of a geographic area that a client is interested in on an ongoing basis (e.g., \"planning area\")."
    QuerySubscriptionParameters:
      type: object
      required:
        - area_of_interest
      properties:
        area_of_interest:
          $ref: '../shared-components/schemas.yaml#/components/schemas/Volume4D'
      description: Parameters for a request to find subscriptions matching the provided criteria.
    QuerySubscriptionsResponse:
      required:
      - subscriptions
      type: object
      properties:
        subscriptions:
          type: array
          description: Subscriptions that overlap the specified geographic area.
          items:
            $ref: '#/components/schemas/Subscription'
          default: []
      description: Response to DSS query for subscriptions in a particular geographic area.
    GetSubscriptionResponse:
      required:
      - subscription
      type: object
      properties:
        subscription:
          $ref: '#/components/schemas/Subscription'
      description: Response to DSS request for the subscription with the given id.
    PutSubscriptionParameters:
      required:
      - uss_base_url
      type: object
      properties:
        area_of_interest:
          description: |-
            Volume of airspace to subscribe to.
            This subscription will automatically be deleted after its end time if it has not been refreshed by then. 
            Note that some Entities triggering notifications may lie entirely outside the requested area.
          $ref: '../shared-components/schemas.yaml#/components/schemas/Volume3D'
        resource_ids:
          description: List of resources for which to create the subscription. 
          type: array
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
        time_start:
          description: If start time is not specified, it will default to the time the request is processed. 
          $ref: '../shared-components/schemas.yaml#/components/schemas/Time'
        time_end:
          description: If end time is not specified, the value will be chosen automatically by the DSS. 
            The end time may not be in the past.
          $ref: '../shared-components/schemas.yaml#/components/schemas/Time'
        uss_base_url:
          $ref: '#/components/schemas/SubscriptionUssBaseURL'
        notify_for_operational_intents:
          type: boolean
          description: "If true, trigger notifications when operational intents are created, updated, or deleted.  Otherwise, changes in operational intents should not trigger notifications.  The scope utm.strategic_coordination is required to set this flag true."
          default: false
        notify_for_resources:
          type: boolean
          description: "If true, trigger notifications when resources are created, updated, or deleted.  Otherwise, changes in resources should not trigger notifications.  The scope utm.constraint_processing is required to set this flag true."
          default: false
      description: Parameters for a request to create/update a subscription in the DSS.  At least one form of notifications must be requested.
        At least one of the volume_of_interest or resource_ids must be provided. A combination of volume and resource ids may be provided. 
    SubscriptionUssBaseURL:
      description: The base URL of a USS implementation of the parts of the USS-USS API necessary for receiving the notifications requested by this subscription.
      $ref: '#/components/schemas/UssBaseURL'
    PutSubscriptionResponse:
      required:
      - subscription
      type: object
      properties:
        subscription:
          $ref: '#/components/schemas/Subscription'
        operational_intent_references:
          type: array
          description: "Operational intents in or near the subscription area at the time of creation/update, if `notify_for_operational_intents` is true."
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/OperationalIntentReference'
          default: []
        resource_references:
          type: array
          description: "Resources in or near the subscription area at the time of creation/update, if `notify_for_resources` is true."
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/ResourceReference'
          default: []
      description: Response for a request to create or update a subscription.
    DeleteSubscriptionResponse:
      required:
      - subscription
      type: object
      properties:
        subscription:
          $ref: '#/components/schemas/Subscription'
      description: Response for a successful request to delete a subscription.
    UssBaseURL:
      type: string
      description: "The base URL of a PSU RIS, OIM or other PSU role implementation of part or all of the PSU-PSU API. "
      example: https://uss.example.com/utm
    OperationalIntentUssBaseURL:
      description: "The base URL of a USS implementation that implements the parts of the USS-USS API necessary for providing the details of this operational intent, and telemetry during non-conformance or contingency, if applicable."
      $ref: '#/components/schemas/UssBaseURL'
    PutOperationalIntentReferenceParameters:
      required:
      - operational_extents
      - state
      - uss_base_url
      type: object
      properties:
        operational_extents:
          $ref: "#/components/schemas/OperationalExtents"
        key:
          description: "Proof that the USS creating or mutating this operational intent was aware of the current state of the airspace, with the expectation that this operational intent accounts for demand and capacity of all relevant resources. This field is not required when declaring an operational intent Nonconforming or Contingent, or when the operational intent does not intersect any capacity constrained resources, but is otherwise required. OVNs are required for intersected resources and all operations utilizing intersected resources. The key does not need to contain the OVN for the operational intent being updated."
          $ref: '#/components/schemas/Key'
        state:
          $ref: '../shared-components/schemas.yaml#/components/schemas/OperationalIntentState'
        uss_base_url:
          $ref: '#/components/schemas/OperationalIntentUssBaseURL'
        subscription_id:
          description: |- 
            The ID of an existing subscription that the USS will use to keep the operator informed
            about updates to relevant airspace information. If this field is not provided when the
            operational intent is in the Accepted, Activated, DCB-Noncompliant, Nonconforming, or 
            Contingent state, then the new_subscription` field must be provided in order to provide
            notification capability for the operational intent.  The subscription specified by this 
            ID must cover at least the area over which this operational intent is conducted, and it 
            must provide notifications for operational intents.
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
        new_subscription:
          description: |- 
            If an existing subscription is not specified in `subscription_id`, and the operational 
            intent is in the Accepted, Activated, DCB-Noncompliant, Nonconforming, or Contingent 
            state, then this field must be populated.  When this field is populated, an implicit 
            subscription will be created and associated with this operational intent, and will 
            generally be deleted automatically upon the deletion of this operational intent.
          $ref: '#/components/schemas/ImplicitSubscriptionParameters'
      description: |-
        Parameters for a request to create an OperationalIntentReference in the DSS. 
        A subscription to changes overlapping this volume may be implicitly created, 
        but this can be overridden by providing the (optional) 'subscription_id' to use. 
        Note: The implicit subscription is managed by the DSS, not the USS.
    ImplicitSubscriptionParameters:
      required:
      - uss_base_url
      type: object
      properties:
        uss_base_url:
          description: "The base URL of a USS implementation of the parts of the USS-USS API necessary for receiving the notifications that the operational intent must be aware of.  This includes, at least, notifications for relevant changes in operational intents."
          $ref: '#/components/schemas/SubscriptionUssBaseURL'
        notify_for_operational_intents:
          type: boolean
          description: "If true, trigger notifications when operational intents are created, updated, or deleted.  Otherwise, changes in operational intents should not trigger notifications.  The scope utm.strategic_coordination is required to set this flag true."
          default: false
        notify_for_resources:
          type: boolean
          description: "If true, trigger notifications when resources are created, updated, or deleted.  Otherwise, changes in resources should not trigger notifications.  The scope utm.constraint_processing is required to set this flag true."
          default: false  
      description: Information necessary to create a subscription to serve a single operational intent's notification needs.
    GetOperationalIntentReferenceResponse:
      required:
      - operational_intent_reference
      type: object
      properties:
        operational_intent_reference:
          $ref: '../shared-components/schemas.yaml#/components/schemas/OperationalIntentReference'
      description: Response to DSS request for the OperationalIntentReference with the given ID.
    ChangeOperationalIntentReferenceResponse:
      required:
      - operational_intent_reference
      - subscribers
      type: object
      properties:
        subscribers:
          type: array
          description: DSS subscribers that this client now has the obligation to notify of the operational intent changes just made.  This client must call POST for each provided URL according to the USS-USS `/uss/v1/operational_intents` path API.  The client's own subscriptions will also be included in this list.
          items:
            $ref: '#/components/schemas/SubscriberToNotify'
          default: []
        operational_intent_reference:
          $ref: '../shared-components/schemas.yaml#/components/schemas/OperationalIntentReference'
      description: "Response to a request to create, update, or delete an OperationalIntentReference in the DSS."
    QueryOperationalIntentReferenceParameters:
      type: object
      properties:
        area_of_interest:
          description: |-
            Volume of airspace to search for operational intents.
          $ref: '../shared-components/schemas.yaml#/components/schemas/Volume3D'
        resource_ids:
          description: List of resources for which to return operational intents using the resource. 
          type: array
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
        time_start:
          description: Start time of the information query. If start time is not specified, it will default to the time the request is processed. 
          $ref: '../shared-components/schemas.yaml#/components/schemas/Time'
        time_end:
          description: End tme of the information query. If end time is not specified, the value will be chosen automatically by the DSS. 
            The end time may not be in the past.
          $ref: '../shared-components/schemas.yaml#/components/schemas/Time'
      description: Parameters for a request to find OperationalIntentReferences matching the provided criteria.  This can be queried by volume and/or
        by the ids of the resources of interest. 
    QueryOperationalIntentReferenceResponse:
      required:
      - operational_intent_references
      type: object
      properties:
        operational_intent_references:
          type: array
          description: OperationalIntentReferences in the area of interest.
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/OperationalIntentReference'
          default: []
      description: Response to DSS query for OperationalIntentReferences in an area of interest.
    ResourceUssBaseURL:
      description: The base URL of a USS implementation that implements the parts of the USS-USS API necessary for providing the details of this resource.
      $ref: '#/components/schemas/UssBaseURL'
    PostResourceReferenceParameters:
      required:
      - extents
      - ris_base_url
      - time_start
      type: object
      properties:
        extents:
          minItems: 1
          type: array
          description: |-
            Spacetime extents that bound this resource.
            The end time may not be in the past.
            All volumes of the resource must be encompassed in these extents. However, these extents do not need to match the precise volumes of the resource; a single bounding extent may be provided instead, for instance.
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/Volume4D'
        ris_base_url:
          $ref: '#/components/schemas/ResourceUssBaseURL'
        subscription_id:
          description: "The ID of an existing subscription that the USS will use to keep the operator informed about updates to relevant airspace information. If this field is not provided when the operational intent is in the Activated, Nonconforming, or Contingent state, then the `new_subscription` field must be provided in order to provide notification capability for the operational intent.  The subscription specified by this ID must cover at least the area over which this operational intent is conducted, and it must provide notifications for operational intents."
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
        new_subscription:
          description: "If an existing subscription is not specified in `subscription_id`, and the operational intent is in the Activated, Nonconforming, or Contingent state, then this field must be populated.  When this field is populated, an implicit subscription will be created and associated with this operational intent, and will generally be deleted automatically upon the deletion of this operational intent."
          $ref: '#/components/schemas/ImplicitSubscriptionParameters'
        time_start:
          description: "Date/time when the resource should begin being considered for DCB."
          $ref: '../shared-components/schemas.yaml#/components/schemas/Time'
        time_end:
          description: "Ending time of the Resource, if applicable. Indefinite if not set."
          $ref: '../shared-components/schemas.yaml#/components/schemas/Time'
        bin_duration:
          description: "Fixed bin duration for resources with FLOW_RATE_FIXED_BIN capacities. Not specified for resources without FLOW_RATE_FIXED_BIN capacities."
          $ref: '../shared-components/schemas.yaml#/components/schemas/CapacityPropertyType'
      description: Parameters for a request to create a ResourceReference in the DSS.
    PutResourceReferenceParameters:
      type: object
      properties:
        extents:
          minItems: 1
          type: array
          description: |-
            Spacetime extents that bound this resource.
            The end time may not be in the past.
            All volumes of the resource must be encompassed in these extents. However, these extents do not need to match the precise volumes of the resource; a single bounding extent may be provided instead, for instance.
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/Volume4D'
        ris_base_url:
          $ref: '#/components/schemas/ResourceUssBaseURL'
        subscription_id:
          description: "The ID of an existing subscription that the USS will use to keep the operator informed about updates to relevant airspace information. If this field is not provided when the operational intent is in the Activated, Nonconforming, or Contingent state, then the `new_subscription` field must be provided in order to provide notification capability for the operational intent.  The subscription specified by this ID must cover at least the area over which this operational intent is conducted, and it must provide notifications for operational intents."
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
        new_subscription:
          description: "If an existing subscription is not specified in `subscription_id`, and the operational intent is in the Activated, Nonconforming, or Contingent state, then this field must be populated.  When this field is populated, an implicit subscription will be created and associated with this operational intent, and will generally be deleted automatically upon the deletion of this operational intent."
          $ref: '#/components/schemas/ImplicitSubscriptionParameters'
        time_start:
          description: "Date/time when the resource should begin being considered for DCB."
          $ref: '../shared-components/schemas.yaml#/components/schemas/Time'
        time_end:
          description: "Ending time of the Resource, if applicable. Indefinite if not set."
          $ref: '../shared-components/schemas.yaml#/components/schemas/Time'
        bin_duration:
          description: "Fixed bin duration for resources with FLOW_RATE_FIXED_BIN capacities. Not specified for resources without FLOW_RATE_FIXED_BIN capacities."
          $ref: '../shared-components/schemas.yaml#/components/schemas/CapacityPropertyType'         
        update_type:
          type: string
          description: The change that warrants notification of peers for the resource. 
          enum:
          - CAPACITY
          - STATUS
          - DEFINITION 
      description: Parameters for a request to update an existing ResourceReference in the DSS.
    GetResourceReferenceResponse:
      required:
      - resource_reference
      type: object
      properties:
        resource_reference:
          $ref: '../shared-components/schemas.yaml#/components/schemas/ResourceReference'
      description: Response to DSS request for the ResourceReference with the given ID.
    ChangeResourceReferenceResponse:
      required:
      - resource_reference
      - subscribers
      type: object
      properties:
        subscribers:
          type: array
          description: DSS subscribers that this client now has the obligation to notify of the resource changes just made.  This client must call POST for each provided URL according to the USS-USS `/uss/v1/resources` path API.  The client's own subscriptions will also be included in this list.
          items:
            $ref: '#/components/schemas/SubscriberToNotify'
          default: []
        resource_reference:
          $ref: '../shared-components/schemas.yaml#/components/schemas/ResourceReference'
      description: "Response to a request to create, update, or delete a ResourceReference. in the DSS."
    QueryResourceReferenceParameters:
      type: object
      required:
        - area_of_interest
      properties:
        area_of_interest:
          $ref: '../shared-components/schemas.yaml#/components/schemas/Volume4D'
      description: Parameters for a request to find ResourceReferences matching the provided criteria.
    QueryResourceReferencesResponse:
      required:
      - resource_references
      type: object
      properties:
        resource_references:
          type: array
          description: ResourceReferences in the area of interest.
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/ResourceReference'
          default: []
      description: Response to DSS query for ResourceReferences in an area of interest.
    AirspaceConflictResponse:
      type: object
      properties:
        message:
          type: string
          description: Human-readable message indicating what error occurred and/or why.
        missing_operational_intents:
          type: array
          description: >
            List of operational intent references for which current proof of knowledge was not
            provided.  If this field is present and contains elements, the responsible USS (e.g., DCB) 
            should query the details URLs for these operational intents to obtain their details and 
            correct OVNs.  The OVNs can be used to update the key, at which point the USS may retry 
            this call.
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/OperationalIntentReference'
          default: []
        missing_resources:
          type: array
          description: >
            List of resource references for which current proof of knowledge was not provided.  If 
            this field is present and contains elements, the responsible USS (e.g., DCB) should 
            query the details URLs for these resources to obtain their details and correct OVNs. The 
            OVNs can be used to update the key, after which the request may be retried.
          items:
            $ref: "../shared-components/schemas.yaml#/components/schemas/ResourceReference"
          default: []          
      description: Data provided when an airspace conflict was encountered.
    VolumeExtents:
      required:
        - volume_extents
      type: object
      properties: 
        volume_extents:
          minItems: 1
          type: array
          description: |-
            Spacetime extents that bound this operational intent. This object is used exclusively for the 
            nominal state of the operation and does not include off-nominal volumes (Nonconforming or Contingent).
            However, these extents do not need to match the precise volumes of the operational intent; a single 
            bounding extent may be provided instead, for instance. Start and end times, as well as lower and 
            upper altitudes, are required for each volume. The end time may not be in the past. Each 
            VolumeExtent includes a list of resources which will be fully occupied for the time duration of the 
            volume. Each VolumeExtent also includes a list of resources which will not be occupied by the 
            operation.  This list is included because the extents of the operations and resources will not 
            perfectly match the actual geography exactly and overlaps of extents without actual resource usage 
            could occur. 
          items:
            $ref: '#/components/schemas/Volume4DExtent'
    OffNominalVolumeExtents:
      required:
        - off_nominal_extents
      type: object
      properties: 
        off_nominal_extents:
          minItems: 1
          type: array
          description: |-
            Spacetime extents that bound this operational intent. This object is used exclusively for 
            off-nominal states, specifically Nonconforming and Contingent. However, these extents do not 
            need to match the precise volumes of the operational intent; a single bounding extent may 
            be provided instead, for instance. Start and end times, as well as lower and upper altitudes, 
            are required for each volume. The end time may not be in the past. 
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/Volume4D'
    PastResourceExtent:
      description: Describes a resource crossing or occupation which has occurred
        in the past for this flight.  The operation and resource OVNs do not need
        to be shared because the operation has already (and is no longer) utilizing
        these resources. The intent of this schema is to allow the DSS to maintain
        past occupation to support DCB. 
      required:
        - resource_id
        - resource_temporal_usage
      type: object
      properties:
        resource_temporal_usage:
          description: |-
            Duration of time for a volume based resource, or crossing Time
            for a waypoint based resource. 
          oneOf:
            - $ref: "../shared-components/schemas.yaml#/components/schemas/ResourceCrossing"
            - $ref: "../shared-components/schemas.yaml#/components/schemas/ResourceOccupationDuration"  
        resource_id:
          description: |-
            The ID of a resources being occupied or crossed by the operational intent. 
            Details of the crossing times and durations are also shared peer-to-peer when the
            operational intent trajectory is shared. 
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityID'
        resource_ovn:
          description: |-
            The OVN of the resource being occupied or crossed by the operational intent. 
            This proves the operation considers the latest status and capacity of the resource. 
          $ref: '../shared-components/schemas.yaml#/components/schemas/EntityOVN'
        operation_ovns:
          description: |-
            The OVNs of all operations contributing to demand at this resource during the
            relevant times based upon resource demand & capacity requirements. 
          type: array
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/EntityOVN'
    ResourceExtents:
      required:
        - resource_extents
      type: object
      properties: 
        resource_extents:        
          minItems: 1
          type: array
          description: |-
            List of resources and crossing OR entry/exit times when the resource
            will be occupied by the Flight Intent. These extents are intended to be
            shared with the DSS when the Operation Intent is submitted/updated. 
          items:
            $ref: '../shared-components/schemas.yaml#/components/schemas/ResourceExtent'
    PastResourceExtents:
      required:
        - past_extents
      type: object
      properties:
        past_extents:
          type: array
          description: |-
            List of resources and OR entry/exit times when the resource was occupied
            by the Flight Intent. 
          items:
            $ref: '#/components/schemas/PastResourceExtent'
    OperationalExtents:
      type: object
      required:
        - extents
      properties:
        extents:
          oneOf:
          - $ref: "#/components/schemas/ResourceExtents"
          - $ref: "#/components/schemas/VolumeExtents"
          - $ref: "#/components/schemas/OffNominalVolumeExtents"
        past_extents:
          description: Describes a resource crossing or occupation which has occurred
            in the past for this flight. Required for resources with FLOW_RATE_FIXED_BIN 
            capacity type, but only for currently active time bins. Not required for 
            time bins that have already completed. Not required for resources with 
            INSTANTEOUS capacity type. The intent of this schema is to allow the DSS to 
            maintain past occupation to support DCB. 
          $ref: "#/components/schemas/PastResourceExtents"
    VehicleTelemetry:
      required:
      - time_measured
      - position
      type: object
      properties:
        time_measured:
          $ref: '../shared-components/schemas.yaml#/components/schemas/Time'
        position:
          $ref: '#/components/schemas/Position'
        velocity:
          $ref: '../shared-components/schemas.yaml#/components/schemas/Velocity'
      description: "Vehicle position, altitude, and velocity."
    PositionAccuracyVertical:
      type: string
      description: "Vertical error that is likely to be present in this reported position. This is the GVA enumeration from ADS-B, plus some finer values for UAS."
      enum:
      - VAUnknown
      - VA150mPlus
      - VA150m
      - VA45m
      - VA25m
      - VA10m
      - VA3m
      - VA1m
    PositionAccuracyHorizontal:
      type: string
      description: "Horizontal error that is likely to be present in this reported position. This is the NACp enumeration from ADS-B, plus 1m for a more complete range for UAS."
      enum:
      - HAUnknown
      - HA10NMPlus
      - HA10NM
      - HA4NM
      - HA2NM
      - HA1NM
      - HA05NM
      - HA03NM
      - HA01NM
      - HA005NM
      - HA30m
      - HA10m
      - HA3m
      - HA1m
    Position:
      type: object
      properties:
        longitude:
          $ref: '../shared-components/schemas.yaml#/components/schemas/Longitude'
        latitude:
          $ref: '../shared-components/schemas.yaml#/components/schemas/Latitude'
        accuracy_h:
          $ref: '#/components/schemas/PositionAccuracyHorizontal'
        accuracy_v:
          $ref: '#/components/schemas/PositionAccuracyVertical'
        extrapolated:
          type: boolean
          description: True if this position was generated primarily by computation rather than primarily from a direct instrument measurement.
          default: false
        altitude:
          $ref: '../shared-components/schemas.yaml#/components/schemas/Altitude'
      description: "Location of the vehicle (UAS) as reported for UTM. Note: 'accuracy' values are required when extrapolated field is true."
    SetUssAvailabilityStatusParameters:
      required:
      - availability
      - old_version
      type: object
      properties:
        old_version:
          type: string
          description: "Version of USS's availability to change, for consistent read-modify-write operations and consistent retry behavior."
          default: ""
        availability:
          $ref: '../shared-components/schemas.yaml#/components/schemas/UssAvailabilityState'
    UssAvailabilityStatusResponse:
      required:
      - status
      - version
      type: object
      properties:
        version:
          type: string
          description: Current version of USS's availability.  Used to change USS's availability.
        status:
          $ref: '../shared-components/schemas.yaml#/components/schemas/UssAvailabilityStatus'
    ChangeUssAvailabilityStatusResponse:
      required:
      - status
      - version
      - subscribers
      type: object
      properties:
        version:
          type: string
          description: Current version of USS's availability.  Used to change USS's availability.
        status:
          $ref: '../shared-components/schemas.yaml#/components/schemas/UssAvailabilityStatus'
        subscribers:
          type: array
          description: |-
            DSS subscribers that this client now has the obligation to notify of the USS status changes just made.  
            This client must call POST for each provided URL according to the USS-USS `/oim/v1/uss_availability` path API.  
            The client's own subscriptions will also be included in this list.
          items:
            $ref: '#/components/schemas/SubscriberToNotify'
          default: []
    Authority:
      type: object
      properties:
        name:
          description: The official name of a public or private authority
          $ref: '#/components/schemas/TextShortType'
        service:
          description: The name of a specific department or service within the organisation
          $ref: '#/components/schemas/TextShortType'
        contact_name:
          description: The name or role of a specific person that needs to be contacted within the organisation
          $ref: '#/components/schemas/TextShortType'
        site_url:
          description: |-
            The URL of the public internet site through which the organisation may be contacted
            Note: in the data coding format, this might be further constrained in order to ensure a valid URL format.
          $ref: '#/components/schemas/TextShortType'
        email:
          description: |-
            The e-mail address by which the organisation may be contacted.
            Note: in the data coding format, this might be further constrained in order to ensure a valid e-mail format.
          $ref: '#/components/schemas/TextShortType'
        phone:
          description: A phone number at which the organisation may be contacted
          $ref: '#/components/schemas/TextShortType'
        purpose:
          description: The role of the Authority in relation with the zone.
          $ref: '#/components/schemas/CodeAuthorityRole'
        interval_before:
          type: string
          description: "The minimal time interval required between notification or authorization request and starting to operate in the zone, in the format PnnDTnnHnnM (ISO 8601)."
          format: duration
      description: |-
        A relevant authority that is in charge for authorising, being notified or providing information for UAS operations in the UAS zone.
        Rule: >-
           at least one of the following shall be specified - siteURL, email,
        phone.
    CodeAuthorityRole:
      type: string
      description: A coded list of values indicating the role that an authority has in relation with the UAS zone.
      enum:
      - AUTHORIZATION
      - NOTIFICATION
      - INFORMATION
    TextShortType:
      maxLength: 200
      type: string
      description: A free text with a maximum length of 200 characters
